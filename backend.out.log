Using Azure PostgreSQL (AAD token)
INFO:     Will watch for changes in these directories: ['/Users/lindseystevens/DNC Portal/backend']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [31434] using WatchFiles
INFO:     Started server process [31515]
INFO:     Waiting for application startup.
2025-09-18 10:48:11.990 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 10:48:13.419 | INFO     | do_not_call.core.database:init_db:70 - Database tables created successfully
INFO:     Application startup complete.
INFO:     127.0.0.1:52888 - "GET /docs HTTP/1.1" 200 OK
INFO:     127.0.0.1:52920 - "OPTIONS /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:52921 - "OPTIONS /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:52925 - "OPTIONS /api/v1/crm/statuses HTTP/1.1" 200 OK
INFO:     127.0.0.1:52926 - "OPTIONS /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:52928 - "OPTIONS /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:52929 - "OPTIONS /api/v1/crm/statuses HTTP/1.1" 200 OK
INFO:     127.0.0.1:52929 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:52920 - "GET /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:52921 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:52926 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:52928 - "GET /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:52925 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:56975 - "OPTIONS /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:56976 - "OPTIONS /api/v1/crm/statuses HTTP/1.1" 200 OK
INFO:     127.0.0.1:56979 - "OPTIONS /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:56981 - "OPTIONS /api/v1/crm/statuses HTTP/1.1" 200 OK
INFO:     127.0.0.1:56983 - "OPTIONS /api/v1/tenants/dnc-requests/org/1?status=pending&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56984 - "OPTIONS /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:56975 - "OPTIONS /api/v1/tenants/dnc-requests/org/1?status=pending&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56981 - "OPTIONS /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:56984 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:56976 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:56979 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:56984 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:56981 - "GET /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:56975 - "GET /api/v1/tenants/dnc-requests/org/1?status=pending&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56984 - "GET /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:56981 - "GET /api/v1/tenants/dnc-requests/org/1?status=pending&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:58902 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:62208 - "OPTIONS /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:62211 - "OPTIONS /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:62213 - "OPTIONS /api/v1/crm/statuses HTTP/1.1" 200 OK
INFO:     127.0.0.1:62215 - "OPTIONS /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:62217 - "OPTIONS /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:62218 - "OPTIONS /api/v1/crm/statuses HTTP/1.1" 200 OK
INFO:     127.0.0.1:62215 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62208 - "GET /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:62213 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:62218 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62215 - "GET /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:62208 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:62266 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:62266 - "GET /favicon.ico HTTP/1.1" 404 Not Found
WARNING:  WatchFiles detected changes in 'do_not_call/api/v1/crm_integrations.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-18 11:19:51.340 | INFO     | do_not_call.main:lifespan:27 - Shutting down Do Not Call List Manager API...
2025-09-18 11:19:51.341 | INFO     | do_not_call.core.database:close_db:80 - Database connections closed
2025-09-18 11:19:51.341 | INFO     | do_not_call.main:lifespan:29 - Database connection closed
INFO:     Application shutdown complete.
INFO:     Finished server process [31515]
INFO:     Started server process [2959]
INFO:     Waiting for application startup.
2025-09-18 11:19:52.171 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 11:19:53.497 | INFO     | do_not_call.core.database:init_db:70 - Database tables created successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'do_not_call/main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-18 11:20:05.110 | INFO     | do_not_call.main:lifespan:27 - Shutting down Do Not Call List Manager API...
2025-09-18 11:20:05.111 | INFO     | do_not_call.core.database:close_db:80 - Database connections closed
2025-09-18 11:20:05.111 | INFO     | do_not_call.main:lifespan:29 - Database connection closed
INFO:     Application shutdown complete.
INFO:     Finished server process [2959]
INFO:     Started server process [3479]
INFO:     Waiting for application startup.
2025-09-18 11:20:05.701 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 11:20:06.928 | INFO     | do_not_call.core.database:init_db:70 - Database tables created successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'do_not_call/main.py', 'do_not_call/api/v1/crm_integrations.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-18 11:20:26.933 | INFO     | do_not_call.main:lifespan:27 - Shutting down Do Not Call List Manager API...
2025-09-18 11:20:26.933 | INFO     | do_not_call.core.database:close_db:80 - Database connections closed
2025-09-18 11:20:26.933 | INFO     | do_not_call.main:lifespan:29 - Database connection closed
INFO:     Application shutdown complete.
INFO:     Finished server process [3479]
INFO:     Started server process [4266]
INFO:     Waiting for application startup.
2025-09-18 11:20:27.520 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 11:20:28.913 | INFO     | do_not_call.core.database:init_db:70 - Database tables created successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'do_not_call/api/v1/crm_integrations.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-18 11:25:42.011 | INFO     | do_not_call.main:lifespan:27 - Shutting down Do Not Call List Manager API...
2025-09-18 11:25:42.011 | INFO     | do_not_call.core.database:close_db:80 - Database connections closed
2025-09-18 11:25:42.011 | INFO     | do_not_call.main:lifespan:29 - Database connection closed
INFO:     Application shutdown complete.
INFO:     Finished server process [4266]
INFO:     Started server process [15107]
INFO:     Waiting for application startup.
2025-09-18 11:25:42.585 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 11:25:43.812 | INFO     | do_not_call.core.database:init_db:70 - Database tables created successfully
INFO:     Application startup complete.
INFO:     127.0.0.1:50742 - "OPTIONS /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:50744 - "OPTIONS /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:50748 - "OPTIONS /api/v1/crm/statuses HTTP/1.1" 200 OK
INFO:     127.0.0.1:50749 - "OPTIONS /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:50750 - "OPTIONS /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:50752 - "OPTIONS /api/v1/crm/statuses HTTP/1.1" 200 OK
INFO:     127.0.0.1:50748 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:50742 - "GET /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:50744 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:50752 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:50750 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:50748 - "GET /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:50748 - "OPTIONS /api/v1/tenants/system/services HTTP/1.1" 200 OK
INFO:     127.0.0.1:50750 - "OPTIONS /api/v1/tenants/system/services HTTP/1.1" 200 OK
INFO:     127.0.0.1:50748 - "GET /api/v1/tenants/system/services HTTP/1.1" 200 OK
INFO:     127.0.0.1:50748 - "OPTIONS /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:50750 - "GET /api/v1/tenants/system/services HTTP/1.1" 200 OK
INFO:     127.0.0.1:50748 - "GET /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:50744 - "OPTIONS /api/v1/tenants/dnc-requests/org/1?status=pending&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50742 - "OPTIONS /api/v1/tenants/dnc-requests/org/1?status=pending&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50752 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:50748 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:50750 - "GET /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:50742 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:50752 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:50744 - "GET /api/v1/tenants/dnc-requests/org/1?status=pending&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50748 - "GET /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:50744 - "GET /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:50752 - "GET /api/v1/tenants/dnc-requests/org/1?status=pending&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:50752 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:50744 - "GET /openapi.json HTTP/1.1" 200 OK
2025-09-18 11:36:46.493 | ERROR    | do_not_call.core.crm_clients.ringcentral:authenticate:35 - RingCentral credentials are not fully configured
2025-09-18 11:36:46.493 | ERROR    | do_not_call.core.crm_clients.ringcentral:authenticate:35 - RingCentral credentials are not fully configured
INFO:     127.0.0.1:51965 - "GET /api/v1/ringcentral/auth/status HTTP/1.1" 200 OK
2025-09-18 11:37:05.557 | ERROR    | do_not_call.core.crm_clients.ringcentral:authenticate:35 - RingCentral credentials are not fully configured
2025-09-18 11:37:05.557 | ERROR    | do_not_call.core.crm_clients.ringcentral:authenticate:35 - RingCentral credentials are not fully configured
INFO:     127.0.0.1:52066 - "GET /api/v1/ringcentral/auth/status HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'do_not_call/main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-18 11:37:33.512 | INFO     | do_not_call.main:lifespan:27 - Shutting down Do Not Call List Manager API...
2025-09-18 11:37:33.512 | INFO     | do_not_call.core.database:close_db:80 - Database connections closed
2025-09-18 11:37:33.513 | INFO     | do_not_call.main:lifespan:29 - Database connection closed
INFO:     Application shutdown complete.
INFO:     Finished server process [15107]
INFO:     Started server process [42743]
INFO:     Waiting for application startup.
2025-09-18 11:37:34.317 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 11:37:35.268 | INFO     | do_not_call.core.database:init_db:70 - Database tables created successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'do_not_call/core/crm_clients/ringcentral.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-18 11:40:11.950 | INFO     | do_not_call.main:lifespan:27 - Shutting down Do Not Call List Manager API...
2025-09-18 11:40:11.951 | INFO     | do_not_call.core.database:close_db:80 - Database connections closed
2025-09-18 11:40:11.951 | INFO     | do_not_call.main:lifespan:29 - Database connection closed
INFO:     Application shutdown complete.
INFO:     Finished server process [42743]
INFO:     Started server process [48781]
INFO:     Waiting for application startup.
2025-09-18 11:40:12.592 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 11:40:13.913 | INFO     | do_not_call.core.database:init_db:70 - Database tables created successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'do_not_call/core/crm_clients/ringcentral.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-18 11:40:39.058 | INFO     | do_not_call.main:lifespan:27 - Shutting down Do Not Call List Manager API...
2025-09-18 11:40:39.059 | INFO     | do_not_call.core.database:close_db:80 - Database connections closed
2025-09-18 11:40:39.059 | INFO     | do_not_call.main:lifespan:29 - Database connection closed
INFO:     Application shutdown complete.
INFO:     Finished server process [48781]
INFO:     Started server process [49769]
INFO:     Waiting for application startup.
2025-09-18 11:40:39.697 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 11:40:40.599 | INFO     | do_not_call.core.database:init_db:70 - Database tables created successfully
INFO:     Application startup complete.
INFO:     127.0.0.1:53447 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:53443 - "GET /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:53445 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:53447 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:53457 - "GET /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:53443 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:53447 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:53457 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:53443 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:53469 - "GET /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:53447 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:53445 - "GET /api/v1/tenants/dnc-requests/org/1?status=pending&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:53457 - "GET /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:53447 - "GET /api/v1/tenants/dnc-requests/org/1?status=pending&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:53447 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:53457 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:53501 - "GET /api/v1/ringcentral/auth/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:53677 - "GET /api/v1/ringcentral/auth/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:54736 - "OPTIONS /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:54738 - "OPTIONS /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:54742 - "OPTIONS /api/v1/crm/statuses HTTP/1.1" 200 OK
INFO:     127.0.0.1:54743 - "OPTIONS /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:54744 - "OPTIONS /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:54736 - "OPTIONS /api/v1/crm/statuses HTTP/1.1" 200 OK
INFO:     127.0.0.1:54743 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:54738 - "GET /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:54742 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:54736 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:54743 - "GET /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:54738 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:54736 - "OPTIONS /api/v1/tenants/dnc-requests/org/1?status=pending&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:54742 - "OPTIONS /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:54744 - "OPTIONS /api/v1/tenants/dnc-requests/org/1?status=pending&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:54746 - "OPTIONS /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:54743 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:54738 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:54746 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:54743 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:54742 - "GET /api/v1/tenants/dnc-requests/org/1?status=pending&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:54736 - "GET /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:54742 - "GET /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:54743 - "GET /api/v1/tenants/dnc-requests/org/1?status=pending&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:54743 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:54742 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:54881 - "GET /api/v1/ringcentral/auth/status HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'do_not_call/api/v1/crm_integrations.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-18 11:45:27.067 | INFO     | do_not_call.main:lifespan:27 - Shutting down Do Not Call List Manager API...
2025-09-18 11:45:27.068 | INFO     | do_not_call.core.database:close_db:80 - Database connections closed
2025-09-18 11:45:27.068 | INFO     | do_not_call.main:lifespan:29 - Database connection closed
INFO:     Application shutdown complete.
INFO:     Finished server process [49769]
INFO:     Started server process [59857]
INFO:     Waiting for application startup.
2025-09-18 11:45:27.830 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 11:45:28.798 | INFO     | do_not_call.core.database:init_db:70 - Database tables created successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'do_not_call/api/v1/crm_integrations.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-18 11:45:40.007 | INFO     | do_not_call.main:lifespan:27 - Shutting down Do Not Call List Manager API...
2025-09-18 11:45:40.007 | INFO     | do_not_call.core.database:close_db:80 - Database connections closed
2025-09-18 11:45:40.007 | INFO     | do_not_call.main:lifespan:29 - Database connection closed
INFO:     Application shutdown complete.
INFO:     Finished server process [59857]
INFO:     Started server process [60382]
INFO:     Waiting for application startup.
2025-09-18 11:45:40.630 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 11:45:41.653 | INFO     | do_not_call.core.database:init_db:70 - Database tables created successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'do_not_call/api/v1/crm_integrations.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-18 11:45:50.848 | INFO     | do_not_call.main:lifespan:27 - Shutting down Do Not Call List Manager API...
2025-09-18 11:45:50.848 | INFO     | do_not_call.core.database:close_db:80 - Database connections closed
2025-09-18 11:45:50.848 | INFO     | do_not_call.main:lifespan:29 - Database connection closed
INFO:     Application shutdown complete.
INFO:     Finished server process [60382]
INFO:     Started server process [60780]
INFO:     Waiting for application startup.
2025-09-18 11:45:51.478 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 11:45:52.338 | INFO     | do_not_call.core.database:init_db:70 - Database tables created successfully
INFO:     Application startup complete.
INFO:     127.0.0.1:55261 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:55259 - "GET /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:55260 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:55261 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:55267 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:55260 - "GET /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:55267 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:55260 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:55269 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:55267 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:55259 - "GET /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:55267 - "GET /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:55261 - "GET /api/v1/tenants/dnc-requests/org/1?status=pending&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:55267 - "GET /api/v1/tenants/dnc-requests/org/1?status=pending&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:55267 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:55261 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:55261 - "GET /api/v1/ringcentral/auth/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:55373 - "GET /api/v1/ringcentral/auth/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:56016 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:56014 - "GET /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:56015 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:56016 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:56018 - "GET /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:56014 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:56014 - "OPTIONS /api/v1/tenants/system/services HTTP/1.1" 200 OK
INFO:     127.0.0.1:56018 - "OPTIONS /api/v1/tenants/system/services HTTP/1.1" 200 OK
INFO:     127.0.0.1:56018 - "GET /api/v1/tenants/system/services HTTP/1.1" 200 OK
INFO:     127.0.0.1:56018 - "GET /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:56014 - "GET /api/v1/tenants/system/services HTTP/1.1" 200 OK
INFO:     127.0.0.1:56014 - "GET /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:56018 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:56014 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:56018 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:56036 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:56015 - "GET /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:56016 - "GET /api/v1/tenants/dnc-requests/org/1?status=pending&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56018 - "GET /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:56015 - "GET /api/v1/tenants/dnc-requests/org/1?status=pending&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56015 - "GET /api/v1/tenants/system/services HTTP/1.1" 200 OK
INFO:     127.0.0.1:56018 - "GET /api/v1/tenants/system/services HTTP/1.1" 200 OK
INFO:     127.0.0.1:56015 - "GET /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:56018 - "GET /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:56018 - "OPTIONS /api/v1/tenants/system/test/ringcentral HTTP/1.1" 200 OK
INFO:     127.0.0.1:56018 - "POST /api/v1/tenants/system/test/ringcentral HTTP/1.1" 200 OK
INFO:     127.0.0.1:56018 - "OPTIONS /api/v1/tenants/system/test/convoso HTTP/1.1" 200 OK
INFO:     127.0.0.1:56018 - "POST /api/v1/tenants/system/test/convoso HTTP/1.1" 200 OK
INFO:     127.0.0.1:56018 - "OPTIONS /api/v1/tenants/system/test/ytel HTTP/1.1" 200 OK
INFO:     127.0.0.1:56018 - "POST /api/v1/tenants/system/test/ytel HTTP/1.1" 200 OK
INFO:     127.0.0.1:56173 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:56172 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:56173 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:56179 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:56176 - "GET /api/v1/tenants/dnc-requests/org/1?status=pending&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56177 - "GET /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:56176 - "GET /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:56179 - "GET /api/v1/tenants/dnc-requests/org/1?status=pending&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56179 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:56176 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:56176 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:56267 - "GET /api/v1/ringcentral/auth/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:56267 - "OPTIONS /api/v1/ringcentral/dnc/list HTTP/1.1" 200 OK
INFO:     127.0.0.1:56267 - "GET /api/v1/ringcentral/dnc/list HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/anyio/streams/memory.py", line 91, in receive_nowait
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 426, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/middleware/errors.py", line 184, in __call__
    raise exc
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/DNC Portal/backend/do_not_call/main.py", line 85, in add_correlation_id
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/DNC Portal/backend/do_not_call/api/v1/crm_integrations.py", line 31, in ringcentral_list_blocked
    from ...core.config import settings
ModuleNotFoundError: No module named 'do_not_call.core.config'
WARNING:  WatchFiles detected changes in 'do_not_call/api/v1/crm_integrations.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-18 11:53:56.463 | INFO     | do_not_call.main:lifespan:27 - Shutting down Do Not Call List Manager API...
2025-09-18 11:53:56.464 | INFO     | do_not_call.core.database:close_db:80 - Database connections closed
2025-09-18 11:53:56.464 | INFO     | do_not_call.main:lifespan:29 - Database connection closed
INFO:     Application shutdown complete.
INFO:     Finished server process [60780]
INFO:     Started server process [77837]
INFO:     Waiting for application startup.
2025-09-18 11:53:57.189 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 11:53:58.196 | INFO     | do_not_call.core.database:init_db:70 - Database tables created successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'do_not_call/api/v1/tenants.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-18 11:54:01.832 | INFO     | do_not_call.main:lifespan:27 - Shutting down Do Not Call List Manager API...
2025-09-18 11:54:01.833 | INFO     | do_not_call.core.database:close_db:80 - Database connections closed
2025-09-18 11:54:01.833 | INFO     | do_not_call.main:lifespan:29 - Database connection closed
INFO:     Application shutdown complete.
INFO:     Finished server process [77837]
INFO:     Started server process [78009]
INFO:     Waiting for application startup.
2025-09-18 11:54:02.458 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 11:54:03.230 | INFO     | do_not_call.core.database:init_db:70 - Database tables created successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'do_not_call/api/v1/crm_integrations.py', 'do_not_call/api/v1/tenants.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-18 11:55:11.056 | INFO     | do_not_call.main:lifespan:27 - Shutting down Do Not Call List Manager API...
2025-09-18 11:55:11.057 | INFO     | do_not_call.core.database:close_db:80 - Database connections closed
2025-09-18 11:55:11.057 | INFO     | do_not_call.main:lifespan:29 - Database connection closed
INFO:     Application shutdown complete.
INFO:     Finished server process [78009]
INFO:     Started server process [80750]
INFO:     Waiting for application startup.
2025-09-18 11:55:11.720 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 11:55:12.556 | INFO     | do_not_call.core.database:init_db:70 - Database tables created successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'do_not_call/api/v1/crm_integrations.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-18 11:55:15.481 | INFO     | do_not_call.main:lifespan:27 - Shutting down Do Not Call List Manager API...
2025-09-18 11:55:15.482 | INFO     | do_not_call.core.database:close_db:80 - Database connections closed
2025-09-18 11:55:15.482 | INFO     | do_not_call.main:lifespan:29 - Database connection closed
INFO:     Application shutdown complete.
INFO:     Finished server process [80750]
INFO:     Started server process [80898]
INFO:     Waiting for application startup.
2025-09-18 11:55:16.118 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 11:55:17.024 | INFO     | do_not_call.core.database:init_db:70 - Database tables created successfully
INFO:     Application startup complete.
INFO:     127.0.0.1:58470 - "OPTIONS /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:58472 - "OPTIONS /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:58476 - "OPTIONS /api/v1/crm/statuses HTTP/1.1" 200 OK
INFO:     127.0.0.1:58477 - "OPTIONS /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:58479 - "OPTIONS /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:58480 - "OPTIONS /api/v1/crm/statuses HTTP/1.1" 200 OK
INFO:     127.0.0.1:58480 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:58479 - "GET /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:58472 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:58476 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:58480 - "GET /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:58472 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:58476 - "OPTIONS /api/v1/tenants/dnc-requests/org/1?status=pending&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:58479 - "OPTIONS /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:58477 - "OPTIONS /api/v1/tenants/dnc-requests/org/1?status=pending&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:58470 - "OPTIONS /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:58480 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:58472 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:58470 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:58480 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:58479 - "GET /api/v1/tenants/dnc-requests/org/1?status=pending&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:58476 - "GET /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:58479 - "GET /api/v1/tenants/users HTTP/1.1" 200 OK
INFO:     127.0.0.1:58480 - "GET /api/v1/tenants/dnc-requests/org/1?status=pending&limit=50 HTTP/1.1" 200 OK
INFO:     127.0.0.1:58480 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:58479 - "GET /openapi.json HTTP/1.1" 200 OK
INFO:     127.0.0.1:58583 - "GET /api/v1/ringcentral/auth/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:58583 - "GET /api/v1/ringcentral/dnc/list HTTP/1.1" 400 Bad Request
WARNING:  WatchFiles detected changes in 'do_not_call/config.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-18 12:04:05.250 | INFO     | do_not_call.main:lifespan:27 - Shutting down Do Not Call List Manager API...
2025-09-18 12:04:05.251 | INFO     | do_not_call.core.database:close_db:80 - Database connections closed
2025-09-18 12:04:05.251 | INFO     | do_not_call.main:lifespan:29 - Database connection closed
INFO:     Application shutdown complete.
INFO:     Finished server process [80898]
INFO:     Started server process [2045]
INFO:     Waiting for application startup.
2025-09-18 12:04:06.034 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 12:04:07.991 | INFO     | do_not_call.core.database:init_db:70 - Database tables created successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'do_not_call/main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-18 12:05:26.345 | INFO     | do_not_call.main:lifespan:27 - Shutting down Do Not Call List Manager API...
2025-09-18 12:05:26.345 | INFO     | do_not_call.core.database:close_db:80 - Database connections closed
2025-09-18 12:05:26.346 | INFO     | do_not_call.main:lifespan:29 - Database connection closed
INFO:     Application shutdown complete.
INFO:     Finished server process [2045]
INFO:     Started server process [4921]
INFO:     Waiting for application startup.
2025-09-18 12:05:26.986 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 12:05:28.052 | INFO     | do_not_call.core.database:init_db:70 - Database tables created successfully
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'do_not_call/main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-18 12:05:32.089 | INFO     | do_not_call.main:lifespan:27 - Shutting down Do Not Call List Manager API...
2025-09-18 12:05:32.090 | INFO     | do_not_call.core.database:close_db:80 - Database connections closed
2025-09-18 12:05:32.090 | INFO     | do_not_call.main:lifespan:29 - Database connection closed
INFO:     Application shutdown complete.
INFO:     Finished server process [4921]
INFO:     Started server process [5120]
INFO:     Waiting for application startup.
2025-09-18 12:05:32.726 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 12:05:33.644 | INFO     | do_not_call.core.database:init_db:70 - Database tables created successfully
INFO:     Application startup complete.
INFO:     127.0.0.1:62513 - "OPTIONS /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:62516 - "OPTIONS /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:62518 - "OPTIONS /api/v1/crm/statuses HTTP/1.1" 200 OK
INFO:     127.0.0.1:62520 - "OPTIONS /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:62522 - "OPTIONS /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:62523 - "OPTIONS /api/v1/crm/statuses HTTP/1.1" 200 OK
INFO:     127.0.0.1:62518 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62513 - "GET /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:62516 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:62523 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62518 - "GET /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:62513 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:62810 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62808 - "GET /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:62809 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:62812 - "GET /api/v1/crm/statuses HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62810 - "GET /api/v1/tenants/auth/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:62808 - "GET /api/v1/phone-numbers/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:62797 - "GET /irs-standards/standards?family_members_under_65%20=4&county_id=1928 HTTP/1.1" 404 Not Found
WARNING:  WatchFiles detected changes in 'do_not_call/api/v1/tenants.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
2025-09-18 15:50:49.208 | INFO     | do_not_call.main:lifespan:27 - Shutting down Do Not Call List Manager API...
2025-09-18 15:50:49.208 | INFO     | do_not_call.core.database:close_db:80 - Database connections closed
2025-09-18 15:50:49.208 | INFO     | do_not_call.main:lifespan:29 - Database connection closed
INFO:     Application shutdown complete.
INFO:     Finished server process [5120]
INFO:     Started server process [60537]
INFO:     Waiting for application startup.
2025-09-18 15:50:50.188 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 15:50:51.109 | ERROR    | do_not_call.core.database:init_db:72 - Error initializing database: (psycopg2.OperationalError) connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR:    Traceback (most recent call last):
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/DNC Portal/backend/do_not_call/main.py", line 21, in lifespan
    await init_db()
  File "/Users/lindseystevens/DNC Portal/backend/do_not_call/core/database.py", line 69, in init_db
    Base.metadata.create_all(bind=engine)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 5924, in create_all
    bind._run_ddl_visitor(
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3251, in _run_ddl_visitor
    with self.begin() as conn:
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3241, in begin
    with self.connect() as conn:
         ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3277, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2440, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.

(Background on this error at: https://sqlalche.me/e/20/e3q8)

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'do_not_call/api/v1/tenants.py'. Reloading...
INFO:     Started server process [60966]
INFO:     Waiting for application startup.
2025-09-18 15:50:58.537 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 15:50:58.706 | ERROR    | do_not_call.core.database:init_db:72 - Error initializing database: (psycopg2.OperationalError) connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR:    Traceback (most recent call last):
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/DNC Portal/backend/do_not_call/main.py", line 21, in lifespan
    await init_db()
  File "/Users/lindseystevens/DNC Portal/backend/do_not_call/core/database.py", line 69, in init_db
    Base.metadata.create_all(bind=engine)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 5924, in create_all
    bind._run_ddl_visitor(
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3251, in _run_ddl_visitor
    with self.begin() as conn:
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3241, in begin
    with self.connect() as conn:
         ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3277, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2440, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.

(Background on this error at: https://sqlalche.me/e/20/e3q8)

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'do_not_call/core/propagation.py'. Reloading...
INFO:     Started server process [31582]
INFO:     Waiting for application startup.
2025-09-18 16:13:37.140 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 16:13:37.495 | ERROR    | do_not_call.core.database:init_db:72 - Error initializing database: (psycopg2.OperationalError) connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR:    Traceback (most recent call last):
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/DNC Portal/backend/do_not_call/main.py", line 21, in lifespan
    await init_db()
  File "/Users/lindseystevens/DNC Portal/backend/do_not_call/core/database.py", line 69, in init_db
    Base.metadata.create_all(bind=engine)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 5924, in create_all
    bind._run_ddl_visitor(
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3251, in _run_ddl_visitor
    with self.begin() as conn:
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3241, in begin
    with self.connect() as conn:
         ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3277, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2440, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.

(Background on this error at: https://sqlalche.me/e/20/e3q8)

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'do_not_call/api/v1/crm_integrations.py'. Reloading...
INFO:     Started server process [32774]
INFO:     Waiting for application startup.
2025-09-18 16:13:58.910 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 16:13:59.043 | ERROR    | do_not_call.core.database:init_db:72 - Error initializing database: (psycopg2.OperationalError) connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR:    Traceback (most recent call last):
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/DNC Portal/backend/do_not_call/main.py", line 21, in lifespan
    await init_db()
  File "/Users/lindseystevens/DNC Portal/backend/do_not_call/core/database.py", line 69, in init_db
    Base.metadata.create_all(bind=engine)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 5924, in create_all
    bind._run_ddl_visitor(
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3251, in _run_ddl_visitor
    with self.begin() as conn:
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3241, in begin
    with self.connect() as conn:
         ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3277, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2440, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.

(Background on this error at: https://sqlalche.me/e/20/e3q8)

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'do_not_call/core/propagation.py', 'do_not_call/api/v1/crm_integrations.py'. Reloading...
INFO:     Started server process [33371]
INFO:     Waiting for application startup.
2025-09-18 16:14:10.793 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 16:14:10.956 | ERROR    | do_not_call.core.database:init_db:72 - Error initializing database: (psycopg2.OperationalError) connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR:    Traceback (most recent call last):
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/DNC Portal/backend/do_not_call/main.py", line 21, in lifespan
    await init_db()
  File "/Users/lindseystevens/DNC Portal/backend/do_not_call/core/database.py", line 69, in init_db
    Base.metadata.create_all(bind=engine)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 5924, in create_all
    bind._run_ddl_visitor(
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3251, in _run_ddl_visitor
    with self.begin() as conn:
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3241, in begin
    with self.connect() as conn:
         ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3277, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2440, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.

(Background on this error at: https://sqlalche.me/e/20/e3q8)

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'do_not_call/api/v1/crm_integrations.py'. Reloading...
INFO:     Started server process [35935]
INFO:     Waiting for application startup.
2025-09-18 16:15:01.489 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 16:15:01.800 | ERROR    | do_not_call.core.database:init_db:72 - Error initializing database: (psycopg2.OperationalError) connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR:    Traceback (most recent call last):
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/DNC Portal/backend/do_not_call/main.py", line 21, in lifespan
    await init_db()
  File "/Users/lindseystevens/DNC Portal/backend/do_not_call/core/database.py", line 69, in init_db
    Base.metadata.create_all(bind=engine)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 5924, in create_all
    bind._run_ddl_visitor(
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3251, in _run_ddl_visitor
    with self.begin() as conn:
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3241, in begin
    with self.connect() as conn:
         ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3277, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2440, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.

(Background on this error at: https://sqlalche.me/e/20/e3q8)

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'do_not_call/api/v1/tenants.py'. Reloading...
INFO:     Started server process [17130]
INFO:     Waiting for application startup.
2025-09-18 16:40:41.149 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 16:40:41.497 | ERROR    | do_not_call.core.database:init_db:72 - Error initializing database: (psycopg2.OperationalError) connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR:    Traceback (most recent call last):
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/DNC Portal/backend/do_not_call/main.py", line 21, in lifespan
    await init_db()
  File "/Users/lindseystevens/DNC Portal/backend/do_not_call/core/database.py", line 69, in init_db
    Base.metadata.create_all(bind=engine)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 5924, in create_all
    bind._run_ddl_visitor(
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3251, in _run_ddl_visitor
    with self.begin() as conn:
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3241, in begin
    with self.connect() as conn:
         ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3277, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2440, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.

(Background on this error at: https://sqlalche.me/e/20/e3q8)

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'do_not_call/api/v1/tenants.py'. Reloading...
INFO:     Started server process [17808]
INFO:     Waiting for application startup.
2025-09-18 16:40:54.662 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 16:40:54.859 | ERROR    | do_not_call.core.database:init_db:72 - Error initializing database: (psycopg2.OperationalError) connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR:    Traceback (most recent call last):
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/DNC Portal/backend/do_not_call/main.py", line 21, in lifespan
    await init_db()
  File "/Users/lindseystevens/DNC Portal/backend/do_not_call/core/database.py", line 69, in init_db
    Base.metadata.create_all(bind=engine)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 5924, in create_all
    bind._run_ddl_visitor(
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3251, in _run_ddl_visitor
    with self.begin() as conn:
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3241, in begin
    with self.connect() as conn:
         ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3277, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2440, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.

(Background on this error at: https://sqlalche.me/e/20/e3q8)

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'do_not_call/core/database.py'. Reloading...
INFO:     Started server process [45658]
INFO:     Waiting for application startup.
2025-09-18 16:49:54.132 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 16:49:54.431 | ERROR    | do_not_call.core.database:init_db:104 - Error initializing database: (psycopg2.OperationalError) connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR:    Traceback (most recent call last):
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/DNC Portal/backend/do_not_call/main.py", line 21, in lifespan
    await init_db()
  File "/Users/lindseystevens/DNC Portal/backend/do_not_call/core/database.py", line 101, in init_db
    Base.metadata.create_all(bind=engine)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 5924, in create_all
    bind._run_ddl_visitor(
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3251, in _run_ddl_visitor
    with self.begin() as conn:
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3241, in begin
    with self.connect() as conn:
         ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3277, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2440, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.

(Background on this error at: https://sqlalche.me/e/20/e3q8)

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'do_not_call/core/database.py'. Reloading...
INFO:     Started server process [47176]
INFO:     Waiting for application startup.
2025-09-18 16:50:23.160 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 16:50:23.368 | ERROR    | do_not_call.core.database:init_db:129 - Error initializing database: (psycopg2.OperationalError) connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR:    Traceback (most recent call last):
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/DNC Portal/backend/do_not_call/main.py", line 21, in lifespan
    await init_db()
  File "/Users/lindseystevens/DNC Portal/backend/do_not_call/core/database.py", line 126, in init_db
    Base.metadata.create_all(bind=engine)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 5924, in create_all
    bind._run_ddl_visitor(
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3251, in _run_ddl_visitor
    with self.begin() as conn:
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3241, in begin
    with self.connect() as conn:
         ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3277, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2440, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.

(Background on this error at: https://sqlalche.me/e/20/e3q8)

ERROR:    Application startup failed. Exiting.
WARNING:  WatchFiles detected changes in 'do_not_call/core/database.py'. Reloading...
INFO:     Started server process [49619]
INFO:     Waiting for application startup.
2025-09-18 16:51:11.919 | INFO     | do_not_call.main:lifespan:20 - Starting Do Not Call List Manager API...
2025-09-18 16:51:12.236 | ERROR    | do_not_call.core.database:init_db:129 - Error initializing database: (psycopg2.OperationalError) connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR:    Traceback (most recent call last):
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/starlette/routing.py", line 677, in lifespan
    async with self.lifespan_context(app) as maybe_state:
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py", line 210, in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/DNC Portal/backend/do_not_call/main.py", line 21, in lifespan
    await init_db()
  File "/Users/lindseystevens/DNC Portal/backend/do_not_call/core/database.py", line 126, in init_db
    Base.metadata.create_all(bind=engine)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/sql/schema.py", line 5924, in create_all
    bind._run_ddl_visitor(
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3251, in _run_ddl_visitor
    with self.begin() as conn:
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3241, in begin
    with self.connect() as conn:
         ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3277, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2440, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 3301, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 629, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/lindseystevens/Library/Caches/pypoetry/virtualenvs/do-not-call-backend-U_1ofiFW-py3.12/lib/python3.12/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "dnc.postgres.database.azure.com" (172.185.50.15), port 5432 failed: FATAL:  The access token has expired. Acquire a new token and try again.

(Background on this error at: https://sqlalche.me/e/20/e3q8)

ERROR:    Application startup failed. Exiting.
